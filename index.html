<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KARA ANIME | NEXT LEVEL</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;900&family=Exo+2:wght@400;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --red: #ff0000;
            --neon: 0 0 15px #ff0000, 0 0 35px rgba(255, 0, 0, 0.5);
            --bg: #050505;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            background: var(--bg);
            color: #fff;
            font-family: 'Exo 2', sans-serif;
            overflow-x: hidden;
            background-image: 
                linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)),
                url('https://i.pinimg.com/originals/a1/33/df/a133df57458145789f258a7413d08595.jpg'); /* Cyberpunk background */
            background-attachment: fixed;
            background-size: cover;
        }

        /* HEADER */
        header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 5%; background: rgba(0,0,0,0.9);
            border-bottom: 2px solid var(--red); position: sticky; top: 0; z-index: 1000;
            backdrop-filter: blur(10px); box-shadow: var(--neon);
        }

        .logo {
            font-family: 'Orbitron', sans-serif; font-size: 26px; font-weight: 900;
            letter-spacing: 4px; color: #fff; text-decoration: none;
            text-shadow: 0 0 10px var(--red);
        }
        .logo span { color: var(--red); }

        .user-block {
            display: flex; align-items: center; gap: 10px;
            background: rgba(255,0,0,0.1); padding: 5px 15px;
            border-radius: 50px; border: 1px solid var(--red);
            box-shadow: var(--neon);
        }
        .user-block img { width: 35px; height: 35px; border-radius: 50%; border: 1.5px solid #fff; }

        /* SEARCH SECTION */
        .search-container { padding: 40px 5% 20px; text-align: center; }
        .main-search {
            width: 100%; max-width: 600px; padding: 18px 25px;
            border-radius: 15px; border: 2px solid #333;
            background: rgba(0,0,0,0.8); color: #fff; font-size: 16px;
            outline: none; transition: 0.3s; box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        .main-search:focus { border-color: var(--red); box-shadow: var(--neon); }

        /* ANIME GRID */
        .content { padding: 20px 5%; }
        .section-title {
            font-family: 'Orbitron', sans-serif; font-size: 20px;
            margin: 30px 0 20px; border-left: 5px solid var(--red);
            padding-left: 15px; text-shadow: 0 0 10px var(--red);
        }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; }
        
        .anime-card {
            background: #111; border-radius: 15px; overflow: hidden;
            border: 1px solid #222; transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative; cursor: pointer;
        }
        .anime-card:hover { transform: scale(1.05); border-color: var(--red); box-shadow: var(--neon); }
        .anime-card img { width: 100%; height: 230px; object-fit: cover; transition: 0.3s; }
        .anime-card:hover img { filter: brightness(1.2); }
        .anime-info { padding: 12px; text-align: center; font-size: 13px; font-weight: bold; background: rgba(0,0,0,0.8); }

        /* POWER PLAYER MODAL */
        #player-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 9999; flex-direction: column;
        }
        .modal-head { padding: 15px; display: flex; justify-content: space-between; border-bottom: 2px solid var(--red); }
        .player-frame { flex-grow: 1; position: relative; }
        .server-switcher { display: flex; gap: 10px; padding: 10px; background: #0a0a0a; overflow-x: auto; }
        .srv-btn { 
            background: #000; color: #fff; border: 1px solid var(--red); padding: 7px 15px;
            border-radius: 5px; cursor: pointer; white-space: nowrap; font-size: 12px;
        }
        .srv-btn.active { background: var(--red); box-shadow: var(--neon); }

        /* LOADING ANIMATION */
        .loader { width: 40px; height: 40px; border: 4px solid var(--red); border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite; margin: 20px auto; display: none; }
        @keyframes spin { to { transform: rotate(360deg); } }

        @media (max-width: 600px) { .grid { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); } }
    </style>
</head>
<body>

<header>
    <a href="#" class="logo">KARA<span>ANIME</span></a>
    <div class="user-block">
        <span style="font-weight: 800; font-size: 12px;">ZHAVOHIR</span>
        <img src="https://i.pinimg.com/736x/88/ef/37/88ef37240c345371f307c088f6110901.jpg" alt="P">
    </div>
</header>

<div class="search-container">
    <input type="text" id="search" class="main-search" placeholder="–ü–æ–∏—Å–∫ –∞–Ω–∏me... (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ù–∞—Ä—É—Ç–æ)" onkeyup="doSearch()">
    <div id="loader" class="loader"></div>
</div>

<div class="content">
    <div class="section-title">‚≠ê –õ–£–ß–®–ï–ï –î–õ–Ø –¢–ï–ë–Ø</div>
    <div class="grid" id="top-grid"></div>

    <div class="section-title">üî• –ù–û–í–ò–ù–ö–ò</div>
    <div class="grid" id="latest-grid"></div>
</div>

<div id="player-modal">
    <div class="modal-head">
        <div id="p-title" style="color: var(--red); font-weight: bold;"></div>
        <div onclick="closePlayer()" style="cursor: pointer; font-weight: 900;">–ó–ê–ö–†–´–¢–¨ [X]</div>
    </div>
    <div class="server-switcher">
        <button class="srv-btn active" onclick="switchSrv(1)">–°–ï–†–í–ï–† 1</button>
        <button class="srv-btn" onclick="switchSrv(2)">–°–ï–†–í–ï–† 2</button>
        <button class="srv-btn" onclick="switchSrv(3)">–°–ï–†–í–ï–† 3</button>
    </div>
    <div class="player-frame" id="player-container"></div>
</div>

<script>
    const SHIKI = 'https://shikimori.one/api/animes';
    let activeTitle = "";

    async function load(params, gridId) {
        document.getElementById('loader').style.display = 'block';
        try {
            const r = await fetch(`${SHIKI}?${params}`);
            const data = await r.json();
            const grid = document.getElementById(gridId);
            grid.innerHTML = '';
            data.forEach(a => {
                const card = document.createElement('div');
                card.className = 'anime-card';
                card.innerHTML = `
                    <img src="https://shikimori.one${a.image.preview}">
                    <div class="anime-info">${a.russian || a.name}</div>
                `;
                card.onclick = () => openPlayer(a.russian || a.name);
                grid.appendChild(card);
            });
        } catch (e) { alert("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç."); }
        document.getElementById('loader').style.display = 'none';
    }

    function openPlayer(title) {
        activeTitle = title;
        document.getElementById('player-modal').style.display = 'flex';
        document.getElementById('p-title').innerText = title;
        switchSrv(1);
    }

    function switchSrv(n) {
        const btns = document.querySelectorAll('.srv-btn');
        btns.forEach((b, i) => b.classList.toggle('active', i === n-1));
        const cont = document.getElementById('player-container');
        const q = encodeURIComponent(activeTitle);

        // QOZOG'ISTON UCHUN ENG KUCHLI KOMBINATSIYA
        if(n === 1) cont.innerHTML = `<iframe src="https://base.karatun.com/search?title=${q}" allowfullscreen></iframe>`;
        if(n === 2) cont.innerHTML = `<iframe src="https://www.alloha.tv/video/search?q=${q}" allowfullscreen></iframe>`;
        if(n === 3) cont.innerHTML = `<iframe src="https://vidsrc.me/embed/anime?search=${q}" allowfullscreen></iframe>`;
    }

    function closePlayer() {
        document.getElementById('player-modal').style.display = 'none';
        document.getElementById('player-container').innerHTML = '';
    }

    function doSearch() {
        const s = document.getElementById('search').value;
        if(s.length > 2) load(`search=${s}&limit=24`, 'latest-grid');
        else if(s.length === 0) init();
    }

    function init() {
        load('ids=51019,52299,617,14813,37451,38524,40052,21,30', 'top-grid');
        load('order=popularity&status=released&limit=24', 'latest-grid');
    }

    init();
</script>
</body>
</html>
